<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Graficador de Desigualdades 3D</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #fbeaff;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }
    h2 {
      color: #d48fce;
    }
    input, button {
      padding: 10px;
      font-size: 16px;
      margin: 5px;
      border: 1px solid #ccc;
      border-radius: 10px;
      width: 300px;
    }
    button {
      background-color: #f4c2f4;
      color: #333;
      cursor: pointer;
    }
    #plot {
      width: 90vw;
      height: 80vh;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h2>Graficador de Desigualdades con Tres Variables</h2>
  <input type="text" id="ineq1" placeholder="Ej: x + y + z <= 10">
  <input type="text" id="ineq2" placeholder="Ej: x - y + z <= 8">
  <input type="text" id="ineq3" placeholder="Ej: 2x + y - z <= 15">
  <button onclick="graficar()">Graficar</button>
  <div id="plot"></div>

  <script>
    function parseInequality(ineq) {
      const match = ineq.match(/([+-]?\s*\d*x)?\s*([+-]?\s*\d*y)?\s*([+-]?\s*\d*z)?\s*(<=|>=|<|>|==)\s*(-?\d+)/i);
      if (!match) return null;
      const parseTerm = (term, variable) => {
        if (!term) return 0;
        term = term.replace(variable, '').trim();
        if (term === '' || term === '+') return 1;
        if (term === '-') return -1;
        return parseFloat(term);
      };
      return {
        A: parseTerm(match[1], 'x'),
        B: parseTerm(match[2], 'y'),
        C: parseTerm(match[3], 'z'),
        op: match[4],
        D: parseFloat(match[5])
      };
    }

    function cumpleDesigualdad({ A, B, C, op, D }, x, y, z) {
      const val = A * x + B * y + C * z;
      switch (op) {
        case "<=": return val <= D;
        case ">=": return val >= D;
        case "<":  return val < D;
        case ">":  return val > D;
        case "==": return val === D;
        default: return false;
      }
    }

    function graficar() {
      const ineqs = [ineq1.value, ineq2.value, ineq3.value].map(parseInequality);

      if (ineqs.includes(null)) {
        alert("Asegúrate de que todas las desigualdades estén en formato válido.");
        return;
      }

      const puntos = { x: [], y: [], z: [] };

      for (let x = -10; x <= 10; x++) {
        for (let y = -10; y <= 10; y++) {
          for (let z = -10; z <= 10; z++) {
            if (ineqs.every(ineq => cumpleDesigualdad(ineq, x, y, z))) {
              puntos.x.push(x);
              puntos.y.push(y);
              puntos.z.push(z);
            }
          }
        }
      }

      const trace = {
        x: puntos.x,
        y: puntos.y,
        z: puntos.z,
        mode: 'markers',
        type: 'scatter3d',
        marker: {
          size: 3,
          color: '#b0e0e6', // azul pastel
          opacity: 0.6
        }
      };

      const layout = {
        margin: { l: 0, r: 0, b: 0, t: 0 },
        scene: {
          xaxis: { title: 'x' },
          yaxis: { title: 'y' },
          zaxis: { title: 'z' }
        }
      };

      Plotly.newPlot('plot', [trace], layout);
    }
  </script>
</body>
</html>
